{
  "hash": "6d0f9d81e1d2e5df84e2d2e9e7b3cc66",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Two-sample *t*-test in R\nsubtitle: Cheatsheet\ndate: today\nlightbox: true\n---\n\n\n\n\n\n\n::: {.grid}\n::: {.g-col-6}\n\n::: {.callout-note collapse=\"true\"}\n## License\nThis work was developed using resources that are available under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/), made available on the [SOLES Open Educational Resources](https://github.com/usyd-soles-edu) repository by the School of Life and Environmental Sciences, The University of Sydney.\n::: \n\n\n\n::: {.callout-note collapse=\"true\"}\n## Assumed knowledge\n- You know how to install and load packages in R.\n- You know how to import data into R.\n- You recognise data frames and vectors.\n:::\n:::\n::: {.g-col-6}\n\n::: {.callout-important collapse=\"true\"}\n## Data structure\nThe data should be in a **long format** (also known as tidy data), where each row is an observation and each column is a variable (@fig-format). If your data is not already structured this way, reshape it manually in a spreadsheet program or in R using the `pivot_longer()` function from the `tidyr` package.\n\n\n::: {layout=\"[ 0.4, -0.1, 0.4 ]\" #fig-format}\n\n:::: {#first-column}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{lr}\n\\toprule\nSex & BW \\\\ \n\\midrule\\addlinespace[2.5pt]\nF & 2.15 \\\\ \nM & 2.55 \\\\ \nF & 2.95 \\\\ \nF & 2.70 \\\\ \nM & 2.20 \\\\ \nF & 1.85 \\\\ \nM & 2.55 \\\\ \nM & 2.60 \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n:::\n\n::: {#second-column}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{rr}\n\\toprule\nF & M \\\\ \n\\midrule\\addlinespace[2.5pt]\n2.15 & 2.55 \\\\ \n2.95 & 2.20 \\\\ \n2.70 & 2.55 \\\\ \n1.85 & 2.60 \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n:::\n\nData should be in long format (left) where each row is an observation and each column is a variable. This is the preferred format for most statistical software. Wide format (right) is also common, but may require additional steps to analyse or visualise in some instances.\n::::\n:::\n\n\n\n::: {.callout-important}\n## Data\nFor this cheatsheet we will use data from the penguins dataset from the `palmerpenguins` package. You may need to install this package:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"palmerpenguins\")\n```\n:::\n\n\n\n\n:::\n:::\n:::\n\n## About \nThe two-sample *t*-test is used to determine whether the means of two independent groups are significantly different from each other. **Examples**:\n\n- **Comparing plant growth:** Is the mean height of plants in a shaded area significantly different from those in a sunlit area?\n- **Species abundance:** Are the mean numbers of a specific bird species found in two different forest types significantly different?\n- **Soil nutrient levels:** Is the mean nitrogen concentration in soil samples from an agricultural field significantly different from that in a nearby natural forest?\n\n## Modelling\n\nThe model used in this cheatsheet is based on the `penguins` dataset.\n\n> Is the bill length of penguins significantly different between male and female penguins?\n\nThe [**simplified model**]{style=\"color:olive\"} for the mathematically-adverse individual is $$\\color{olive}\\text{bill length} \\sim \\text{sex}$$ which translates to \"the bill length of penguins is influenced by sex\".\n The [**statistical model**]{style=\"color:red\"} is $$\\color{red}\\text{bill length} = \\beta_0 + \\beta_1 \\cdot sex + \\epsilon$$ where $\\beta_0$ is the mean of the first group in the `sex` variable (in this case, female), $\\beta_1$ is the difference in means between the two groups, and $\\epsilon$ is the error term.\n\n### Preparing the data\nExtract **only** the variables of interest from the dataset using `select()` from the `dplyr` package. This makes it easier to work with the data, especially if cleaning is required. In this case, there are `NA` values in the `sex` column, so we remove them using `drop_na(sex)`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(dplyr)\ndata(penguins)\ndf <- penguins |>\n  select(bill_length_mm, sex) |>\n  drop_na(sex)\n```\n:::\n\n\n\n\n\n\nYour own data should be in a similar format.\n\n## Analytical approaches\nThe traditional approach to the two-sample *t*-test is to use the `t.test()` function in R, while the modern approach is to use a general linear model (GLM) with the `lm()` or `glm()` functions.\n\n::: panel-tabset\n\n## `t.test()` function\n\n### Methods reporting\n\n> Assumption checks for normality and homogeneity of variance were performed performed using the [insert check(s)] and [insert check(s)], respectively. Both groups were found to be normally distributed and have equal variance, so a two-sample *t*-test was used to determine whether the mean body weight of possums was significantly different from 3.5 kg. This was computed using the `t.test()` function in R version 4.4.0 (R Core Team, 2024). \n\n### Check assumption(s)\nIn the traditional approach, assumptions of normality and homogeneity of variance are checked using the raw data and can be done **before** performing the *t*-test. \n\n::: callout-note\nAssumption checks are not required to be reported in the results, but it is good practice to include them in the methods section and indicate how they were checked.\n:::\n\n#### Normality\nAny of the following methods can be used to check for normality. It is important to note that using raw data to check for assumptions requires each group (i.e. sex) to be checked **separately**.\n\n::: panel-tabset\n\n## Histogram\n\nThe histogram shows that the data is not normally distributed as it is multimodal.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(df, aes(x = bill_length_mm)) +\n  geom_histogram(binwidth = 1) +\n  facet_wrap( ~ sex) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](two-sample-ttest-r_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n## Q-Q plot\n\nThe Q-Q plot shows that the data is not normally distributed as many points do not fall on the line. The S-shaped curvature indicates underdispersion.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(sample = bill_length_mm)) +\n  stat_qq() +\n  stat_qq_line() +\n  facet_wrap( ~ sex) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](two-sample-ttest-r_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Shapiro-Wilk test\n\nThis test is not recommended for large sample sizes (> 50) as it is sensitive to even the smallest deviations from normality. Nevertheless, if you choose to use it, the results show that the data is not normally distributed in either group since the p-value is less than 0.05.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  filter(sex == \"male\") |>\n  pull(bill_length_mm) |>\n  shapiro.test()\n\ndf |>\n  filter(sex == \"female\") |>\n  pull(bill_length_mm) |>\n  shapiro.test()\n```\n:::\n\n\n\n:::\n\n#### Equal variance\n\nEyeballing a boxplot of the data can be used to check for homogeneity of variance. The `var.test()` and `leveneTest()` functions can also be used to check for homogeneity of variance, with the latter being more robust. **In general, it is preferable to not rely on the results of these formal tests if the samples are not normally distributed.**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \nvar.test(bill_length_mm ~ sex, df)\n\n# Levene's test\nlibrary(car)\nleveneTest(bill_length_mm ~ sex, df)\n```\n:::\n\n\n\n\n\n\n### Perform the analysis\nThese days, irregardless of whether the data meets the assumptions of equal variance, or not, the Welch's *t*-test is recommended since it will provide almost identical results to the traditional *t*-test if equal variance is met anyway.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(bill_length_mm ~ sex, data = df)\n```\n:::\n\n\n\n\n\n### How to report results\n> The mean bill length of penquins was significantly different between males and females (Welch's *t*~329~ = -6.67, p < 0.001). Mean male bill length (45.9 mm) is higher than mean female bill length (42.1 mm).\n\n## `lm()` function\n\n### Methods reporting\n> A general linear model was used to determine whether the bill length of penguins is significantly different between the two sexes by fitting the model `bill length ~ sex`. This was computed using the `lm()` function in R version 4.4.0 (R Core Team, 2024). The assumptions of normality and homogeneity of variance were checked visually using the residuals of the model. Normality was not met but the analysis was still performed using a GLM as the sample size was large enough to assume that the sampling distribution of the mean is approximately normal.\n\n### Perform the analysis\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(bill_length_mm ~ sex, data = df)\nsummary(fit)\n```\n:::\n\n\n\n\n### Check assumption(s)\n\nWith a GLM, assumptions of normality and homogeneity of variance are checked using the residuals of the model. A `plot()` function can be used to check these assumptions.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(fit)\n```\n\n::: {.cell-output-display}\n![](two-sample-ttest-r_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n### How to report results\n\n> There is evidence to suggest that the mean bill length of penguins is significantly different between sexes (GLM, F~1, 331~ = 44.5, p < 0.001). Male penguins had a higher mean bill length than females (mean difference = 3.76 mm).\n:::\n",
    "supporting": [
      "two-sample-ttest-r_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n\\usepackage{anyfontsize}\n\\usepackage{multirow}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}